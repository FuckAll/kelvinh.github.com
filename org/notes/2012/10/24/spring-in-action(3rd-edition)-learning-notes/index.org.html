<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<!-- Created by htmlize-1.40 in css mode. -->
<html>
  <head>
    <title>index.org</title>
    <style type="text/css">
    <!--
      body {
        color: #839496;
        background-color: #002b36;
      }
      .bold {
        /* bold */
        font-weight: bold;
      }
      .comment {
        /* font-lock-comment-face */
        color: #586e75;
        font-style: italic;
      }
      .italic {
        /* italic */
        text-decoration: underline;
      }
      .org-block {
        /* org-block */
        color: #586e75;
      }
      .org-block-begin-line {
        /* org-block-begin-line */
        color: #586e75;
        font-style: italic;
      }
      .org-block-end-line {
        /* org-block-end-line */
        color: #586e75;
        font-style: italic;
      }
      .org-code {
        /* org-code */
        color: #586e75;
      }
      .org-document-info {
        /* org-document-info */
        color: #afeeee;
      }
      .org-document-info-keyword {
        /* org-document-info-keyword */
        color: #586e75;
      }
      .org-document-title {
        /* org-document-title */
        color: #afeeee;
        font-size: 144%;
        font-weight: bold;
      }
      .org-level-1 {
        /* org-level-1 */
        color: #268bd2;
      }
      .org-level-2 {
        /* org-level-2 */
        color: #2aa198;
      }
      .org-meta-line {
        /* org-meta-line */
        color: #586e75;
        font-style: italic;
      }
      .org-table {
        /* org-table */
        color: #87cefa;
      }

      a {
        color: inherit;
        background-color: inherit;
        font: inherit;
        text-decoration: inherit;
      }
      a:hover {
        text-decoration: underline;
      }
    -->
    </style>
  </head>
  <body>
    <pre>
<span class="org-document-info-keyword">#+TITLE:</span><span class="comment">       </span><span class="org-document-title">Spring in Action(3rd edition) Learning Notes</span>
<span class="org-document-info-keyword">#+AUTHOR:</span><span class="comment">      </span><span class="org-document-info">Kelvin Hu</span>
<span class="org-document-info-keyword">#+EMAIL:</span><span class="comment">       </span><span class="org-document-info">ini.kelvin@gmail.com</span>
<span class="org-document-info-keyword">#+DATE:</span><span class="comment">        </span><span class="org-document-info">2012-10-24 Wed</span>
<span class="org-meta-line">#+KEYWORDS:    java, spring</span>
<span class="org-meta-line">#+CATEGORY:    notes</span>
<span class="org-meta-line">#+TAGS:        :J2EE:Spring:</span>
<span class="org-meta-line">#+LANGUAGE:    en</span>
<span class="org-meta-line">#+OPTIONS:     H:3 num:nil toc:nil \n:nil @:t ::t |:t ^:nil -:t f:t *:t &lt;:t</span>
<span class="org-meta-line">#+DESCRIPTION: reading notes of book Spring in Action</span>

This file recorded all the notes during learning <span class="italic">/Spring in Action 3rd Edition/</span>,
I did not complete the book, and may continue to finish reading it later.

<span class="org-level-1">* Chapter 2 Wiring beans</span>

  All namespaces could be contained in spring xml configuration file:

  <span class="org-table">| namespace | purpose                                           |</span>
  <span class="org-table">|-----------+---------------------------------------------------|</span>
  <span class="org-table">| aop       | for AOP                                           |</span>
  <span class="org-table">| beans     | declaration of beans and how they should be wired |</span>
  <span class="org-table">| context   | ...                                               |</span>
  <span class="org-table">| jee       | integration with Java EE APIs (JNDI, EJB, etc.)   |</span>
  <span class="org-table">| jms       | ...                                               |</span>
  <span class="org-table">| lang      | ...                                               |</span>
  <span class="org-table">| mvc       | spring MVC                                        |</span>
  <span class="org-table">| oxm       | spring object-to-xml mapping                      |</span>
  <span class="org-table">| tx        | transaction configuration                         |</span>
  <span class="org-table">| util      | ...                                               |</span>

<span class="org-level-2">** Wiring beans through constructor</span>

   The bean below will be wired by its default constructor:

   <span class="org-code">: &lt;bean id="hello" class="ini.kelvin.spring.Hello" /&gt;
</span>
   But if the bean definition does not have a default constructor:

   <span class="org-code">: &lt;bean id="hello" class="ini.kelvin.spring.Hello"&gt;
</span>   <span class="org-code">:     &lt;constructor-arg value="someValue" /&gt;
</span>   <span class="org-code">:     &lt;constructor-arg ref="beanId" /&gt;
</span>   <span class="org-code">: &lt;bean&gt;
</span>
   The example above will use the constructor which has two args, 1st one is
   basic type(err.. String should also be considered as "basic type"), 2nd
   one is an instance of an object, so it should be defined with <span class="org-code">=&lt;bean&gt;=</span> tag
   and then the <span class="org-code">=ref=</span> is the reference of that bean, whose id is <span class="org-code">=beanId=</span>.

<span class="org-level-2">** Wiring beans through factory method</span>

   Some definition of classes may not have a visible constructor, an example
   is the singleton bean definition, as below:

<span class="org-block-begin-line">   #+begin_src java
</span><span class="org-block">   public class Singleton {
       private Singleton() {}

       public static Singleton getInstance() {
           return SingletonHolder.instance;
       }

       private static class SingletonHolder {
           private static Singleton instance = new Singleton();
       }
   }
</span><span class="org-block-end-line">   #+end_src
</span>
   Under this condition, we can use following to construct the bean:

   <span class="org-code">: &lt;bean id="singleton"
</span>   <span class="org-code">:       class="Singleton"
</span>   <span class="org-code">:       factory-method="getInstance" /&gt;
</span>
<span class="org-level-2">** Bean scoping</span>

   The definition of bean scope is as following:

   <span class="org-table">|----------------+------------------------------------------------|</span>
   <span class="org-table">| Scope          | Description                                    |</span>
   <span class="org-table">|----------------+------------------------------------------------|</span>
   <span class="org-table">| singleton      | only one bean </span><span class="org-table"><span class="bold">*per spring container*</span></span><span class="org-table"> (</span><span class="org-table"><span class="bold">*default |</span></span><span class="bold">
   </span><span class="org-table"><span class="bold">|                | scoping*</span></span><span class="org-table">)                                      |</span>
   <span class="org-table">|----------------+------------------------------------------------|</span>
   <span class="org-table">| prototype      | once per use                                   |</span>
   <span class="org-table">|----------------+------------------------------------------------|</span>
   <span class="org-table">| request        | scopes a bean to an HTTP request, only valid   |</span>
   <span class="org-table">|                | when used in a web-capable spring context      |</span>
   <span class="org-table">|                | (such as with SpringMVC)                       |</span>
   <span class="org-table">|----------------+------------------------------------------------|</span>
   <span class="org-table">| session        | to an HTTP session, similar to </span><span class="org-table"><span class="org-code">=request=</span></span><span class="org-table">       |</span>
   <span class="org-table">|----------------+------------------------------------------------|</span>
   <span class="org-table">| global-session | to a global HTTP session, valid in a portlet   |</span>
   <span class="org-table">|                | context                                        |</span>
   <span class="org-table">|----------------+------------------------------------------------|</span>

<span class="org-level-2">** Initializing and destroying</span>

   Specify attributes <span class="org-code">=init-method=</span> and <span class="org-code">=destroy-method=</span> in a bean definition,
   the method specified by <span class="org-code">=init-method=</span> will be invoked after the bean is
   constructed, and the method specified by <span class="org-code">=destroy-method=</span> will be invoked
   before the bean is removed from the container.

   <span class="org-code">: &lt;bean id="xxx"
</span>   <span class="org-code">:       class="xxx.Resource"
</span>   <span class="org-code">:       init-method="allocateResource"
</span>   <span class="org-code">:       destroy-method="freeResource" /&gt;
</span>
   As the example shows, the required resources will be allocated after
   constructed, and the resources will be freed before bean removed.

<span class="org-level-2">** Wiring beans through property setting methods</span>

   <span class="org-code">=&lt;property&gt;=</span> is like <span class="org-code">=&lt;constructor-arg&gt;=</span>, example:

   <span class="org-code">: &lt;bean id="hello" class="ini.kelvin.spring.Hello"&gt;
</span>   <span class="org-code">:     &lt;property name="stringProperty" value="someValue" /&gt;
</span>   <span class="org-code">:     &lt;property name="objectProperty" ref="beanId" /&gt;
</span>   <span class="org-code">: &lt;bean&gt;
</span>
   In the example above, the method <span class="org-code">=setStringProperty=</span> will be invoked to
   inject the value <span class="org-code">=someValue=</span>, and <span class="org-code">=setObjectProperty=</span> will be invoked to
   set the related property to the bean referenced by <span class="org-code">=beanId=</span>.

   NOTICE: the attribute <span class="org-code">=name=</span> of <span class="org-code">=property=</span> should be related to the set
   method, not the field name, e.g. field name is <span class="org-code">=realProperty=</span>, but the
   set method is <span class="org-code">=setFakeProperty=</span>, so the <span class="org-code">=name=</span> should be <span class="org-code">=fakeProperty=</span>.

   In the example above, if there are several <span class="org-code">=property=</span>, and all of them
   have <span class="org-code">=ref=</span> to "beanId", then the bean with id "beanId" will be shared
   by all of them. The example below will create a standalone <span class="org-code">=InnerBean=</span>,
   only available for bean "hello":

   <span class="org-code">: &lt;bean id="hello" class="ini.kelvin.spring.Hello"&gt;
</span>   <span class="org-code">:     &lt;property name="stringProperty" value="someValue" /&gt;
</span>   <span class="org-code">:     &lt;property name="objectProperty"&gt;
</span>   <span class="org-code">:         &lt;bean class="package.path.InnerBean" /&gt;
</span>   <span class="org-code">:     &lt;/property&gt;
</span>   <span class="org-code">: &lt;bean&gt;
</span>
<span class="org-level-2">** Wiring collections</span>

   Elements for collection wiring:

   <span class="org-table">|--------------------+------------------------------------------------|</span>
   <span class="org-table">| Collection element | Description                                    |</span>
   <span class="org-table">|--------------------+------------------------------------------------|</span>
   <span class="org-table">| &lt;list&gt;             | Wiring a list of values, allowing duplicates   |</span>
   <span class="org-table">|--------------------+------------------------------------------------|</span>
   <span class="org-table">| &lt;set&gt;              | Wiring a set of values, ensuring no duplicates |</span>
   <span class="org-table">|--------------------+------------------------------------------------|</span>
   <span class="org-table">| &lt;map&gt;              | Wiring name-value pairs, key and value could   |</span>
   <span class="org-table">|                    | be of any type                                 |</span>
   <span class="org-table">|--------------------+------------------------------------------------|</span>
   <span class="org-table">| &lt;props&gt;            | Wiring name-value pairs, key and value should  |</span>
   <span class="org-table">|                    | be both </span><span class="org-table"><span class="org-code">=String=</span></span><span class="org-table">                               |</span>
   <span class="org-table">|--------------------+------------------------------------------------|</span>

   An example of <span class="org-code">=&lt;list&gt;=</span> (<span class="org-code">=&lt;set&gt;=</span> is similar):

   <span class="org-code">: &lt;bean ...&gt;
</span>   <span class="org-code">:     &lt;property name="countries"&gt;
</span>   <span class="org-code">:         &lt;list&gt;
</span>   <span class="org-code">:             &lt;ref bean="China" /&gt;
</span>   <span class="org-code">:             &lt;ref bean="USA" /&gt;
</span>   <span class="org-code">:             ...
</span>   <span class="org-code">:         &lt;/list&gt;
</span>   <span class="org-code">:     &lt;/property&gt;
</span>   <span class="org-code">: &lt;/bean&gt;
</span>
   An example of <span class="org-code">=&lt;map&gt;=</span>:

   <span class="org-code">: &lt;bean ...&gt;
</span>   <span class="org-code">:     &lt;property name="keyValuePair"&gt;
</span>   <span class="org-code">:         &lt;map&gt;
</span>   <span class="org-code">:             &lt;entry key="key1" value-ref="Obj1" /&gt;
</span>   <span class="org-code">:             &lt;entry key="key2" value-ref="Obj2" /&gt;
</span>   <span class="org-code">:             ...
</span>   <span class="org-code">:         &lt;/map&gt;
</span>   <span class="org-code">:     &lt;/property&gt;
</span>   <span class="org-code">: &lt;/bean&gt;
</span>
   The <span class="org-code">=&lt;entry&gt;=</span> element contains a key value pair, both key and value could
   be a primitive value or a reference to another bean, when key/value is a
   primitive value, <span class="org-code">=&lt;key&gt;=</span> / <span class="org-code">=&lt;value&gt;=</span> should be used; when key/value
   referenced to other bean, <span class="org-code">=&lt;key-ref&gt;=</span> / <span class="org-code">=&lt;value-ref&gt;=</span> shoud be used.

   An example of <span class="org-code">=&lt;props&gt;=</span>:

   <span class="org-code">: &lt;bean ...&gt;
</span>   <span class="org-code">:     &lt;property name="personalInfo"&gt;
</span>   <span class="org-code">:         &lt;props&gt;
</span>   <span class="org-code">:             &lt;prop key="name"&gt;Kelvin Hu&lt;/prop&gt;
</span>   <span class="org-code">:             &lt;prop key="email"&gt;ini.kelvin@gmail.com&lt;/prop&gt;
</span>   <span class="org-code">:             ...
</span>   <span class="org-code">:         &lt;/props&gt;
</span>   <span class="org-code">:     &lt;/property&gt;
</span>   <span class="org-code">: &lt;/bean&gt;
</span>
<span class="org-level-2">** Wiring nothing(null)</span>

   Example:

   <span class="org-code">: &lt;property ...&gt;
</span>   <span class="org-code">:     &lt;null /&gt;
</span>   <span class="org-code">: &lt;/property&gt;
</span>
<span class="org-level-2">** Spring expression language (SpEL):</span>

   <span class="bold">*This section is omitted.*</span>

<span class="org-level-1">* Chapter 3 Minimizing XML configuration in Spring</span>

  - Autowiring helps reduce <span class="org-code">=&lt;property&gt;=</span> and <span class="org-code">=&lt;constructor-arg&gt;=</span>.
  - Autodiscovery helps reduce <span class="org-code">=&lt;bean&gt;=</span>.

<span class="org-level-2">** Automatically wiring</span>

   - <span class="org-code">=byName=</span> : search beans, if a bean's id matches the property name, then
     it will be wired into this property

   - <span class="org-code">=byType=</span> : search beans, search criteria is class type

   - <span class="org-code">=constructor=</span> : search beans, the beans which can satisfy the bean's
     constructor wil be used to construct the bean

   - <span class="org-code">=autodetect=</span> : try autowiring by <span class="org-code">=constructor=</span> first, if no suitable
     constructor or bean is found, then try autowiring by type.

<span class="org-level-2">** Wiring with annotations</span>

   By default annotation wiring is turned off, use the following line to
   turn it on:

   <span class="org-code">: &lt;context:annotation-config /&gt;
</span>
   Autowiring annotations:

   1) <span class="org-code">=@Autowired=</span> / <span class="org-code">=@Qualifier=</span>

   2) <span class="org-code">=@Inject=</span> / <span class="org-code">=@Named=</span> / <span class="org-code">=@Qualifier=</span>

   3) <span class="org-code">=@Value=</span> (for primitive types, useful while using with SpEL)

   4) <span class="org-code">=@Resource=</span>

<span class="org-level-2">** Automatically discovering</span>

   <span class="org-code">=&lt;context:annotation-config&gt;=</span> is only used for automatically wiring, but
   <span class="org-code">=&lt;context:component-scan&gt;=</span> will used for both autowiring, but also
   autodiscovery, as below:

   <span class="org-code">: &lt;beans ...&gt;
</span>   <span class="org-code">:     &lt;context:component-scan base-package="com.mycompany.xxx"&gt;
</span>   <span class="org-code">:     &lt;/context:component-scan&gt;
</span>   <span class="org-code">: &lt;/beans&gt;
</span>
   Annotations can be used:

   1) <span class="org-code">=@Component=</span> : general-purpose annotation, indicating that the class
      is a Spring component

   2) <span class="org-code">=@Controller=</span> : defines a Spring MVC controller

   3) <span class="org-code">=@Repository=</span> : defines a data repository

   4) <span class="org-code">=@Service=</span> : defines a service

   5) any customized annotation annotated with <span class="org-code">=@Component=</span>

   <span class="org-code">=&lt;context:component-scan&gt;=</span> can include <span class="org-code">=&lt;context:include-filter&gt;=</span> and
   <span class="org-code">=&lt;context:exclude-filter&gt;=</span> to tweak component scanning. <span class="bold">*(this section
   is omitted, since it is not used so much)*</span>

<span class="org-level-2">** Java-based configuration</span>

   <span class="bold">*not used so often, omitted*</span>

<span class="org-level-1">* Chapter 4 Aspect-oriented Spring</span>

  AOP terminology

  - <span class="bold">*ADVICE*</span>
    The job that aspects are meant to do, is called <span class="italic">/advice/</span>, advice defines
    both the <span class="italic">/what/</span> and the <span class="italic">/when/</span> of an aspect.

    Spring aspects can work with five kinds of advice:
    - <span class="italic">/Before/</span>: the advice functionality takes place before the advised method
      is invoked
    - <span class="italic">/After/</span>: after advised method completes, no matter success or failure
    - <span class="italic">/After-returning/</span>: after succeeded completion
    - <span class="italic">/After-throwing/</span>: after exception-thrown completion
    - <span class="italic">/Around/</span>: both before and after

  - <span class="bold">*JOIN POINTS*</span>
    A <span class="italic">/join point/</span> is a point in the execution of the application where an
    aspect can be plugged in. This point could be a method being called, an
    exception being thrown, or a field being modified.

  - <span class="bold">*POINTCUTS*</span>
    Advice defines the <span class="italic">/what/</span> and the <span class="italic">/when/</span> of aspects, then <span class="italic">/pointcuts/</span>
    define the <span class="italic">/where/</span>. A pointcut defines a set of join points at which the
    advice should be woven.

  - <span class="bold">*ASPECTS*</span>
    An <span class="italic">/aspect/</span> is the merger of advice and pointcuts, advice and pointcuts
    define an aspect: what is does, and, where and when it does it.

  - <span class="bold">*INTRODUCTIONS*</span>
    An <span class="italic">/introduction/</span> allows to add new methods or attributes to existing
    classes.

  - <span class="bold">*WEAVING*</span>
    <span class="italic">/Weaving/</span> is the process of applying aspects to a target object to create
    a new proxied object. There are three points that weaving can take place:
    <span class="italic">/Compile time/</span>, <span class="italic">/Classload time/</span>, and <span class="italic">/Runtime/</span>.

<span class="org-level-2">** Declaring aspects in XML</span>

   <span class="org-table">|---------------------------+---------------------------------------------|</span>
   <span class="org-table">| AOP configuration element | Purpose                                     |</span>
   <span class="org-table">|---------------------------+---------------------------------------------|</span>
   <span class="org-table">| &lt;aop:config&gt;              | The top-level AOP element.                  |</span>
   <span class="org-table">|---------------------------+---------------------------------------------|</span>
   <span class="org-table">| &lt;aop:advisor&gt;             | an AOP advisor                              |</span>
   <span class="org-table">|---------------------------+---------------------------------------------|</span>
   <span class="org-table">| &lt;aop:after&gt;               | an AOP after advice                         |</span>
   <span class="org-table">|---------------------------+---------------------------------------------|</span>
   <span class="org-table">| &lt;aop:after-returning&gt;     | an AOP after-returning advice               |</span>
   <span class="org-table">|---------------------------+---------------------------------------------|</span>
   <span class="org-table">| &lt;aop:after-throwing&gt;      | an AOP after-throwing advice                |</span>
   <span class="org-table">|---------------------------+---------------------------------------------|</span>
   <span class="org-table">| &lt;aop:around&gt;              | an AOP around advice                        |</span>
   <span class="org-table">|---------------------------+---------------------------------------------|</span>
   <span class="org-table">| &lt;aop:aspect&gt;              | an aspect                                   |</span>
   <span class="org-table">|---------------------------+---------------------------------------------|</span>
   <span class="org-table">| &lt;aop:aspectj-autoproxy&gt;   | enables annotation-driven aspects using     |</span>
   <span class="org-table">|                           | @AspectJ                                    |</span>
   <span class="org-table">|---------------------------+---------------------------------------------|</span>
   <span class="org-table">| &lt;aop:before&gt;              | an AOP before advice                        |</span>
   <span class="org-table">|---------------------------+---------------------------------------------|</span>
   <span class="org-table">| &lt;aop:declare-parents&gt;     | introduces additional interfaces to advised |</span>
   <span class="org-table">|                           | objects that are transparently implemented  |</span>
   <span class="org-table">|---------------------------+---------------------------------------------|</span>
   <span class="org-table">| &lt;aop:pointcut&gt;            | a pointcut                                  |</span>
   <span class="org-table">|---------------------------+---------------------------------------------|</span>

   A typical configuration:

   <span class="org-code">: &lt;bean id="aspectBean" class="package.AspectBean" /&gt;
</span>   <span class="org-code">: ...
</span>   <span class="org-code">: &lt;aop:config&gt;
</span>   <span class="org-code">:     &lt;aop:aspect ref="aspectBean"&gt;
</span>   <span class="org-code">:         &lt;aop:pointcut id="aPointCut"
</span>   <span class="org-code">:             expression="execution(* package.class.method(..))" /&gt;
</span>   <span class="org-code">:         &lt;aop:before pointcut-ref="aPointCut" method="aspectMethod" /&gt;
</span>   <span class="org-code">:     &lt;/aop:aspect&gt;
</span>   <span class="org-code">: &lt;/aop:config&gt;
</span>
   For the example above, the class definition <span class="org-code">=package.AspectBean=</span> should
   have a method named <span class="org-code">=aspectMethod=</span>, which will be invoked before the
   execution of <span class="org-code">=package.class.method()=</span>.

   But, for the type <span class="org-code">=&lt;aop:around&gt;=</span>, it is not that simple like the example
   above. The XML configuration of this type is similar to <span class="org-code">=&lt;aop:before&gt;=</span>,
   but the method <span class="org-code">=aspectMethod=</span> defined in <span class="org-code">=package.AspectBean=</span> should have
   the following prototype:
   <span class="org-code">: public void aspectMethod(ProceedingJoinPoint joinPoint)
</span>   and the invocation of <span class="org-code">=joinPoint.proceed()=</span> will invoke the advised
   method, so code blocks can be put before and after this invocation, which
   can implement the effect of "around".

<span class="org-level-2">** Annotating aspects</span>

   <span class="bold">*omitted*</span>

<span class="org-level-1">* Chapter 5 Hitting the database</span>

  Several options to configure a data source:

  - Data source defined by a JDBC driver
  - Data source looked up by JNDI
  - Data source pool connections(C3P0, DBCP, etc.)

  PS: This chapter seems quite simple, no more to note.

<span class="org-level-1">* Chapter 6 Managing transactions</span>

  A transaction manager should be chosen first:
  <span class="org-code">=DataSourceTransactionManager=</span>, <span class="org-code">=HibernateTransactionManager=</span>, etc.
</pre>
  </body>
</html>
